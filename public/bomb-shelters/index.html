<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.7.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Amit Levinson">

  
  
  
    
  
  <meta name="description" content="While rockets were fired towards Israel I decided to take the opportunity and plot  bomb shelters in Beer-Sheva.">

  
  <link rel="alternate" hreflang="en-us" href="/bomb-shelters/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/zenburn.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/zenburn.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Arapey:400,400i%7CKarla:400,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-156329952-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           document.location = url;
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target);  
  }

  gtag('js', new Date());
  gtag('config', 'UA-156329952-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hudc5a425b3e555d4faa8838526864126b_16079_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hudc5a425b3e555d4faa8838526864126b_16079_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/bomb-shelters/">

  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@Amit_Levinson">
  <meta property="twitter:creator" content="@Amit_Levinson">
  
  <meta property="og:site_name" content="Amit Levinson">
  <meta property="og:url" content="/bomb-shelters/">
  <meta property="og:title" content="Mapping bomb shelters in Be&#39;er-Sheva, IL | Amit Levinson">
  <meta property="og:description" content="While rockets were fired towards Israel I decided to take the opportunity and plot  bomb shelters in Beer-Sheva."><meta property="og:image" content="/bomb-shelters/featured.png">
  <meta property="twitter:image" content="/bomb-shelters/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2020-01-14T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2020-01-15T21:55:54&#43;02:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/bomb-shelters/"
  },
  "headline": "Mapping bomb shelters in Be'er-Sheva, IL",
  
  "image": [
    "/bomb-shelters/featured.png"
  ],
  
  "datePublished": "2020-01-14T00:00:00Z",
  "dateModified": "2020-01-15T21:55:54+02:00",
  
  "author": {
    "@type": "Person",
    "name": "Amit Levinson"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Amit Levinson",
    "logo": {
      "@type": "ImageObject",
      "url": "img//"
    }
  },
  "description": "While rockets were fired towards Israel I decided to take the opportunity and plot  bomb shelters in Beer-Sheva."
}
</script>

  

  


  


  


  <title>Mapping bomb shelters in Be&#39;er-Sheva, IL | Amit Levinson</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Amit Levinson</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Amit Levinson</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Blog</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks"><span>Talks</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Mapping bomb shelters in Be&#39;er-Sheva, IL</h1>

  

  
    

    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Jan 15, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    6 min read
  </span>
  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="">R</a></span>
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      
<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/leaflet/leaflet.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet/leaflet.js"></script>
<link href="/rmarkdown-libs/leafletfix/leafletfix.css" rel="stylesheet" />
<script src="/rmarkdown-libs/Proj4Leaflet/proj4-compressed.js"></script>
<script src="/rmarkdown-libs/Proj4Leaflet/proj4leaflet.js"></script>
<link href="/rmarkdown-libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet-binding/leaflet.js"></script>


<div id="update-from-march-21-2020" class="section level4">
<h4><a id="update"></a><strong>Update from March 21, 2020</strong></h4>
<p>I’ve been wanting to return to this post and make this map more interactive. As a matter of fact it was easier than I thought, I just never got around to doing it. I won’t be going through the code for the leaflet map below but will leave it for whoever would like to review it:</p>
<pre class="r"><code>library(leaflet)
library(magrittr)
readr::read_csv(&quot;shelters.csv&quot;) %&gt;% 
leaflet() %&gt;% 
  addTiles() %&gt;% 
  setView(34.7913, 31.25181,zoom = 13) %&gt;% 
  addCircles(radius = 4, color = &quot;red&quot;, fill = TRUE)</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircles","args":[[31.259018768,31.2597950910001,31.2592493760001,31.2573049280001,31.2574797520001,31.258424086,31.254246294,31.255173057,31.2556456460001,31.253666206,31.2537330280001,31.2569812850001,31.2570752350001,31.257608025,31.2575462630001,31.2700855640001,31.2702905,31.2695012190001,31.2658482960001,31.259725431,31.2646111440001,31.266921333,31.2604320470001,31.2596058720001,31.262762868,31.263789048,31.261942934,31.2638102080001,31.2632644710001,31.263504445,31.262432614,31.2708580180001,31.2711996570001,31.270725645,31.2712747300001,31.2718630300001,31.2720855330001,31.2726126790001,31.272427384,31.2704051920001,31.266736774,31.2628119170001,31.2455927190001,31.248994151,31.250188747,31.2459192310001,31.24676858,31.2479923820001,31.2478412890001,31.249363784,31.250175772,31.248725547,31.248610904,31.251846362,31.2518736100001,31.250946067,31.253505949,31.257884104,31.2540270010001,31.2559118880001,31.2710156910001,31.271205497,31.270356722,31.269982842,31.2698227120001,31.269304209,31.269990116,31.2687801060001,31.2682527530001,31.2683451450001,31.270695158,31.27323147,31.2733343200001,31.2737922810001,31.2728741080001,31.274249592,31.2746572610001,31.272394175,31.2739432400001,31.2744760080001,31.2717045570001,31.2729638220001,31.2757156430001,31.2741278410001,31.2746324350001,31.274596902,31.271494137,31.2718457610001,31.275141078,31.275589424,31.2759297440001,31.2649303200001,31.270103943,31.2659409890001,31.2669887380001,31.2697833300001,31.2704315440001,31.266575474,31.266131746,31.221500807,31.224164194,31.223587228,31.2258336940001,31.222024801,31.2197570490001,31.221235918,31.224912993,31.224000586,31.2261810250001,31.223021734,31.2238066,31.2209769780001,31.222977471,31.2321786260001,31.2324369340001,31.2431229220001,31.235916617,31.238806793,31.237065128,31.248259068,31.251491909,31.2504392380001,31.2504933070001,31.2518083160001,31.246153377,31.250630739,31.25563615,31.256696517,31.254957205,31.257290099,31.25460144,31.256567933,31.255031301,31.2575173870001,31.2579245330001,31.2579056490001,31.2226565670001,31.224564345,31.2426843960001,31.240248009,31.2399610090001,31.267945217,31.2638298580001,31.270236595,31.269875347,31.265144816,31.2690648330001,31.2681699770001,31.269377084,31.265713315,31.270953035,31.2722040720001,31.2645033750001,31.271228369,31.2715811,31.256697924,31.257101161,31.269666226,31.275281239,31.274241079,31.269109099,31.272405753,31.2598086400001,31.250707328,31.251678113,31.2525321090001,31.2486613240001,31.2554510690001,31.2490194850001,31.2670087990001,31.2682888350001,31.269309503,31.250801417,31.268097267,31.2679672850001,31.267170004,31.261017135,31.2604871560001,31.261171405,31.260286697,31.260856463,31.258957008,31.2669088850001,31.264312395,31.2644250700001,31.262675503,31.262628384,31.266354108,31.2378694280001,31.237196182,31.2522976180001,31.2551276230001,31.2555366730001,31.271009238,31.2697859260001,31.248898803,31.250194783,31.250113594,31.248703956,31.2482595930001,31.247643195,31.252913957,31.2562439010001,31.250285107,31.2561600820001,31.2510416860001,31.249713179,31.258150351,31.2590159170001,31.2581197600001,31.25558649,31.2571552970001,31.254918092,31.2545320300001,31.2465726200001,31.2520725430001,31.261599754,31.2721663470001,31.270971611,31.2616581070001,31.264973377,31.2658491130001,31.2688886780001,31.2683040970001,31.2707125310001,31.271428288,31.254769068,31.257070663,31.2465921090001,31.2692059390001,31.2443915640001,31.2314304170001,31.269208157,31.269363072,31.270308577,31.2595743270001,31.2700607460001,31.2564875580001,31.2479156200001,31.2481547410001,31.254812955,31.266566502,31.2504635080001,31.2541823770001,31.2683791260001,31.271307544,31.2482951640001,31.2737507580001,31.272590789,31.2570404000001,31.252699315,31.2517972700001,31.2663416,31.2709878490001,31.2660293330001,31.25408293,31.2701366480001,31.2402113960001,31.2646567780001,31.2463304390001,31.2347788370001,31.252428283],[34.808214546,34.8078915740001,34.809368438,34.8093634950001,34.810975436,34.810334568,34.805622382,34.8026935250001,34.804473768,34.8095251010001,34.8075520780001,34.808555186,34.7651206140001,34.76364862,34.7628454490001,34.778674504,34.7777073990001,34.7762277100001,34.770138844,34.7869285290001,34.795184944,34.7997725760001,34.7940810010001,34.7916208840001,34.7906790590001,34.79068958,34.7927366010001,34.79231459,34.7927492380001,34.792743929,34.7905235110001,34.7883433920001,34.7867639080001,34.785602972,34.7852056130001,34.787070295,34.787588817,34.7939116200001,34.7924905290001,34.7941080740001,34.8014500780001,34.792161772,34.7956425140001,34.7970971840001,34.7970376860001,34.7936621440001,34.7914949660001,34.784890746,34.787583614,34.7873553950001,34.7857147330001,34.779422326,34.7796193240001,34.7841264850001,34.7828629210001,34.7779282610001,34.782604796,34.7832538050001,34.7900850610001,34.7963698560001,34.806238138,34.8089210210001,34.809585251,34.8086036290001,34.809357278,34.8091260510001,34.8067740120001,34.8089092710001,34.8086805990001,34.8079129270001,34.804323229,34.800439962,34.8088667390001,34.8085067230001,34.809244467,34.808135475,34.8077908650001,34.8096215740001,34.8069308010001,34.806502575,34.8037255140001,34.802776814,34.802732577,34.8024465140001,34.8025668970001,34.804125362,34.802364975,34.8055181280001,34.8074389120001,34.8070149960001,34.8064910510001,34.7604294980001,34.7639117040001,34.765621094,34.7664207510001,34.7608955090001,34.7630732060001,34.7598450790001,34.7611068100001,34.775540274,34.7789006310001,34.7774103090001,34.778600274,34.7726666250001,34.773724196,34.7718155210001,34.775669044,34.780235401,34.780269586,34.7763314490001,34.775308716,34.7743583120001,34.7736159990001,34.7923748970001,34.78033953,34.779738781,34.784380764,34.7847258240001,34.7817552400001,34.792498504,34.7868126540001,34.789983894,34.789128825,34.787953332,34.7942136410001,34.7945532960001,34.7903546790001,34.7959888820001,34.7941725480001,34.795403445,34.7891443610001,34.793907173,34.7965042000001,34.7892947980001,34.781547866,34.783656121,34.7751580730001,34.780917947,34.781822312,34.781617833,34.783344335,34.7623511370001,34.762642929,34.771785949,34.7709577200001,34.7636153930001,34.7619093160001,34.7644633370001,34.764872847,34.7577812160001,34.770979358,34.765673103,34.7643799360001,34.767547478,34.769529817,34.773305672,34.773415368,34.805293723,34.805267585,34.800891017,34.808306987,34.806721075,34.8088518340001,34.8019847370001,34.8065743970001,34.810013871,34.8081264090001,34.7780347280001,34.782620235,34.7707858410001,34.7723190740001,34.774894422,34.77918176,34.7948698500001,34.7970907800001,34.795007293,34.79702511,34.7965872190001,34.795338615,34.7935443280001,34.7929193080001,34.7929353970001,34.7939598030001,34.795247798,34.797073217,34.7944644400001,34.7974265890001,34.792997642,34.785492021,34.7889980750001,34.804945893,34.8100962180001,34.808716111,34.783396279,34.7850399330001,34.795998975,34.805139436,34.8028419560001,34.8061534390001,34.804344707,34.807264053,34.81146289,34.806185188,34.806567597,34.81037658,34.80369548,34.8085987040001,34.811233825,34.809843013,34.8094435680001,34.8080172910001,34.810334235,34.8070907060001,34.8035195030001,34.8086055260001,34.802861137,34.7937478430001,34.7956186760001,34.793586141,34.7919188430001,34.79992937,34.801187988,34.8012474810001,34.792345267,34.7969623870001,34.794766757,34.8086733960001,34.80687017,34.776587685,34.79294107,34.791070099,34.7935582580001,34.7954634880001,34.7948531970001,34.7868227160001,34.7857320460001,34.795653003,34.791395838,34.7796560830001,34.781008178,34.77898084,34.794873022,34.780569927,34.8023777060001,34.7968104340001,34.7835412000001,34.7892121180001,34.807038339,34.8080192800001,34.8085495820001,34.779316936,34.8025542940001,34.7698468990001,34.8072728060001,34.8008629990001,34.8116456560001,34.7842904080001,34.7950379800001,34.7961240610001,34.8083349930001,34.7825503890001,34.808149154],4,null,null,{"interactive":true,"className":"","stroke":true,"color":"red","weight":5,"opacity":0.5,"fill":true,"fillColor":"red","fillOpacity":0.2},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]}],"setView":[[31.25181,34.7913],13,[]],"limits":{"lat":[31.2197570490001,31.2759297440001],"lng":[34.7577812160001,34.8116456560001]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="original-post" class="section level2">
<h2><strong>Original post</strong></h2>
<p>I’ve been wanting to learn how to use maps in R for a while before creating the map in this post. Seeing dataframes with longitude and latitude coordinates on various occasions on <a href="https://github.com/rfordatascience/tidytuesday">#Tidytuesday</a> encouraged me to do so.<br />
A day before this visualizaiton, I discovered our municupality’s open access data <a href="https://www.beer-sheva.muni.il/OpenData/Pages/default.aspx">website</a>. In this website you can find various datasets like street light coordinates, bomb shelters spread out in the city and more. A day after discovering it Israel, the country I live in, was fired missiles at. I decided to take the opportunity and map some of the shelters around my house. You know, just in case.</p>
<p>Let’s begin with the packages (📦) we’ll need:</p>
<pre class="r"><code>#for data manipulation
library(tidyverse)
#for a nice map
library(ggmap)
#for reading and working with .geojson file
library(geojsonio)
library(sp)
#for integrating a nice font
library(extrafont)</code></pre>
<div id="loading-and-tidying-the-data" class="section level3">
<h3>Loading and tidying the data</h3>
<p>I initially tried using the <code>.csv</code> file they have on their webiste but I was having too much trouble with the Hebrew so I decided to try and work with the <code>geojsonio</code> package. I had no idea how to work with a <code>.geojson</code> file or frankly how to work with maps in general. To my save, i found this incredible blog by <a href="https://randomjohn.github.io/r-geojson-srt/">John Johnson</a> to help me transform a ‘geomjson’ file to a dataframe you can work with.</p>
<p>Let’s begin:</p>
<pre class="r"><code>#read the .geojson file
my_geojson &lt;- &quot;shelters.geojson&quot;
#convert the .geojson file to an sp object
data_json &lt;- geojson_read(my_geojson, what = &quot;sp&quot;)
#now we can convert it to a nice data frame
shelters &lt;- as.data.frame(data_json)
#last tidying of the column names
names(shelters)[6:7] &lt;- c(&quot;long&quot;, &quot;lat&quot;)</code></pre>
<p>What we did was load the geojson file, read it as an ‘sp’ object and then turn it into to a dataframe. I changed the names so that it’ll be easier to read the columns. we could also use <code>dplyr::rename</code> but I liked the base R function Johnson used in his blog so I’ll stick with that.<br />
let’s look at the top 3 observations of our new data frame:</p>
<pre><code>##       long      lat        name X.U.05E7..U.05D5..U.05D3._.U.05E1.
## 1 34.80821 31.25902  &lt;U+05D2&gt;/2                                 17
## 2 34.80789 31.25980  &lt;U+05D2&gt;/1                                 17
## 3 34.80937 31.25925 &lt;U+05D2&gt;/25                                 17
##                elc group_ F_.U.05E6..U.05D5..U.05D5..U.05EA.
## 1 &lt;U+05D9&gt;&lt;U+05E9&gt;      0                                   
## 2 &lt;U+05D9&gt;&lt;U+05E9&gt;      0                                   
## 3 &lt;U+05D9&gt;&lt;U+05E9&gt;      0</code></pre>
<p>Ugh, well the names weren’t read well into <code>R</code>. While this isn’t a big issue to resolve, I don’t find it necessary for the final piece. the names of the shelters are anyway in Hebrew and only represnt a letter and some sort of number (for e.g, A/23, only in Hebrew). Therefore we’ll leave it as is since what I’m interested in is the longitude and latitude coordinations and for that we don’t need the character column.</p>
</div>
<div id="retrieving-the-map" class="section level3">
<h3>Retrieving the map</h3>
<p>So we have our data frame with long and lat points, let’s get our map. I want a map that can be readable in terms of streets and roads, therefore I’ll give the <code>ggmap</code> package a try<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. Google requires you to register in order to recieve an API key to pull maps to plot. Unfortunately I won’t cover how to regiser in this blog post but I’m sure you can find plenty of tutorials addressing it online.<br />
Let’s get Be’er-Sheva’s map:</p>
<pre class="r"><code>b7_map &lt;- get_map(location = c(34.7913 , 31.25181), 
              zoom = 13, scale = 2, maptype = &quot;roadmap&quot;)</code></pre>
<p>What we did here was use the <code>get_map</code> function to pull the map according to the long and lat coordinates I gave it of Be’er-Sheva. You should first pass the longitude and then the latitude in the <code>location</code> argument. In addition you can change other features such as the zoom level, the maptype and more as we saw here (See <code>?get_map</code> for more info).</p>
</div>
<div id="plot" class="section level3">
<h3>Plot</h3>
<p>Now that we have our data set ready and the map as an object we can go on to plot it. ggmap extends ggplot features so we can run the data frame smoothly into the <code>ggmap</code> function:</p>
<pre class="r"><code>ggmap(b7_map)+
  geom_point(shelters, mapping = aes(long,lat),
            color = &quot;red&quot;, size = 0.3, shape = 15)</code></pre>
<p><img src="/post/bomb-shelters/index_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>What we did was pass the b7_map as an object into the <code>ggmap</code> function and add a geom, in this case <code>geom_point</code> representing our shelter coordinates. However, this map doesn’t really help me in a time of need since it doesn’t show <em>my address</em> clearly.</p>
<p>Let’s try zooming in so that we can see what we’re looking at:</p>
<pre class="r"><code>#retreiving a new map with a greater `zoom`
b7_map_zoom &lt;- get_map(location = c(34.7913 , 31.25181), 
                    zoom = 16, scale = 2, maptype = &quot;roadmap&quot;)

p &lt;- ggmap(b7_map_zoom)+
geom_point(shelters, mapping = aes(long,lat), color = &quot;red&quot;,
           size = 3, shape = 15)
p</code></pre>
<p><img src="/post/bomb-shelters/index_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Much nicer and clearer. Using the zoom option in <code>get_map</code> enables to center more on where I want. Great, this shows me some bomb shetlers I have around me in a time of need. Let’s add some fine tuning for our theme:</p>
<pre class="r"><code>p+  
#for the title, caption and removing the X and Y axis
  labs (title = &quot;Neighborhood B, Beer-Sheva, Israel, bomb shelters&quot;,
        x = NULL, y = NULL,
        caption = &quot;data: www.beer-sheva.muni.il | @Amit_Levinson&quot;)+
  theme_minimal()+
  theme(text = element_text(family = &quot;Microsoft Tai Le&quot;),
    #Changing the position of the title
    plot.title = element_text(hjust = 0.5, size = 20, face = &quot;bold&quot;),
    axis.text = element_blank(),
    plot.caption = element_text(size = 9, face = &quot;italic&quot;, hjust = 0),
    panel.border = element_rect(color = &quot;black&quot;, size=2, fill = NA)
  )</code></pre>
<p><img src="/post/bomb-shelters/index_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Perfect, I can now save the plot and distribute it if someone needs it.</p>
<pre class="r"><code>ggsave(&quot;shelters_b_eng.png&quot;, width = 8, height = 8)</code></pre>
<center>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">1.  I&#39;ve been wanting to learn to plot maps in <a href="https://twitter.com/hashtag/rstats?src=hash&amp;ref_src=twsrc%5Etfw">#rstats</a><br>2. Yesterday I encountered open data our municipality publishes<br>3. Today missiles are fired towards Israel in response to assassination of a top terrorist.<br><br>1+2+3: Plotting bomb shelter locations near where I live<a href="https://twitter.com/hashtag/ggmap?src=hash&amp;ref_src=twsrc%5Etfw">#ggmap</a> <a href="https://t.co/4Irz0ZKuZr">pic.twitter.com/4Irz0ZKuZr</a></p>&mdash; Amit Levinson (@Amit_Levinson) <a href="https://twitter.com/Amit_Levinson/status/1194274713759039488?ref_src=twsrc%5Etfw">November 12, 2019</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

</center>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>For a first map I decided to go with a static one, but an interactive one can defenitely be a 2.0 version of this blog (as you saw with the <a href="#update">March 21st update</a>. Hopefully we won’t need it.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/ggmap/">ggmap</a>
  
  <a class="badge badge-light" href="/tags/rvest/">rvest</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/bomb-shelters/&amp;text=Mapping%20bomb%20shelters%20in%20Be&amp;#39;er-Sheva,%20IL" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/bomb-shelters/&amp;t=Mapping%20bomb%20shelters%20in%20Be&amp;#39;er-Sheva,%20IL" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Mapping%20bomb%20shelters%20in%20Be&amp;#39;er-Sheva,%20IL&amp;body=/bomb-shelters/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/bomb-shelters/&amp;title=Mapping%20bomb%20shelters%20in%20Be&amp;#39;er-Sheva,%20IL" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Mapping%20bomb%20shelters%20in%20Be&amp;#39;er-Sheva,%20IL%20/bomb-shelters/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/bomb-shelters/&amp;title=Mapping%20bomb%20shelters%20in%20Be&amp;#39;er-Sheva,%20IL" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hub71a408706e589f09faa92e611c4d1ab_121232_250x250_fill_q90_lanczos_center.jpg" alt="Photo of Amit Levinson">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Amit Levinson</a></h5>
      <h6 class="card-subtitle">Sociology MA student</h6>
      <p class="card-text">I&rsquo;m an avid R user and interested in R analysis, drug markets and political participation.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
    
    
    
    
    <li>
      <a href="mailto:amitlevinson1@gmail.com" >
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/Amit_Levinson" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/AmitLevinson" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/amit-levinson-b23851150" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://amitlevinson.com/cv/" target="_blank" rel="noopener">
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  



  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    

    
    

    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    <script src="/js/academic.min.e5c8525332f417fe3589df9a6b25b6c4.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/"></a>
    
    
       &middot; 
      <a href="/terms/"></a>
    
  </p>
  
  
  
  


 <p class="powered-by">
    © Amit Levinson 2020 &middot; 

    Made in <a href="https://cran.r-project.org/" target="_blank" rel="noopener"><i class="fab fa-r-project"></i>
</a> with <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a><a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener"> Academic theme</a>
 &#183; <a href="https://www.r-bloggers.com/" target="_blank" rel="noopener">R-Bloggers</a>

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
